(provide 'alxest-unicode)
;; Input of unicode symbols
(require 'math-symbol-lists)
; Automatically use math input method for Coq files
(add-hook 'coq-mode-hook (lambda () (set-input-method "math")))
(add-hook 'coq-mode-hook (lambda () (setq current-input-method "math")))
(defun activate-default-input-method ()
  (interactive)
  (activate-input-method default-input-method))
(add-hook 'coq-mode-hook 'activate-default-input-method)
;; (add-hook 'coq-mode-hook (lambda ()
;;   (progn (progn (print "A") (set-input-method "math")) (print "B"))))
;; (add-hook 'coq-mode-hook (lambda () (activate-input-method "math")))
;; (eval-after-load "coq" '(set-input-method "math"))
; Input method for the minibuffer
(defun my-inherit-input-method ()
  "Inherit input method from `minibuffer-selected-window'."
  (let* ((win (minibuffer-selected-window))
         (buf (and win (window-buffer win))))
    (when buf
      (activate-input-method (buffer-local-value 'current-input-method buf)))))
(add-hook 'minibuffer-setup-hook #'my-inherit-input-method)
; Define the actual input method
(quail-define-package "math" "UTF-8" "Î©" t)
(quail-define-rules ; add whatever extra rules you want to define here...
 ("\\!"   ?Çƒ)
 ("\\u"   ?â†‘)
 ("\\d"   ?â†“)
 ("\\s"   ?Î£)
 ("\\e"   ?Îµ) ;Ïµ
 ("\\aa"  ?â—)
 ("\\af"  ?â—¯)
 ("\\+"   ?â‹…)
 ("\\*"   ?âˆ˜)
 ;; ("\\ent"    ?âŠ¢)
 ("\\valid"  ?âœ“)
 ("\\box"    ?â–¡)
 ;; ("\\later"  ?â–·)
 ;; ("\\pred"   ?Ï†)
 ("\\a"    ?âˆ§)
 ("\\o"     ?âˆ¨)
 ;; ("\\comp"   ?âˆ˜)
 ;; ("\\ccomp"  ?â—)
 ;; ("\\all"    ?âˆ€)
 ;; ("\\ex"     ?âˆƒ)
 ;; ("\\to"     ?â†’)
 ;; ("\\*"    ?âˆ—)
 ("\\lc"     ?âŒœ)
 ("\\rc"     ?âŒ)
 ("\\ld"     ?âŒ)
 ("\\rd"     ?âŒŸ)
 ("\\sep"     ?âˆ—)
 ;; ("\\lam"    ?Î»)
 ;; ("\\empty"  ?âˆ…)
 ;; ("\\Lam"    ?Î›)
 ;; ("\\Sig"    ?Î£)
 ;; ("\\-"      ?âˆ–)
 ;; ("\\aa"     ?â—)
 ;; ("\\af"     ?â—¯)
 ;; ("\\iff"    ?â†”)
 ;; ("\\gname"  ?Î³)
 ("\\incl"   ?â‰¼)
 ;; ("\\latert" ?â–¶)
 ("\\cong"     ?â‰…)
 ("\\s-"     ?â»)
 ("\\s+"     ?âº)
 ("\\s1"     ?Â¹)
 ("\\sl"     ?Ì¸)
 ("\\lr"     ?âŸ¶)
 ("\\dr"     ?âŸ¹)
 ("\\prod"     ?âˆ)
 ("\\coprod"     ?âˆ)
 ("\\bplus"     ?ï¼‹)
 ("\\lam"     ?Î»)
 ("\\mref"     ?âŠ‘)
 ("\\mrefr"     ?âŠ’)
 ("\\W"     ?ğ‘Š)
 ("\\w"     ?ğ‘¤)
 ("\\M"     ?ğ‘€)
)
(mapc (lambda (x)
        (if (cddr x)
            (quail-defrule (cadr x) (car (cddr x)))))
      (append math-symbol-list-basic math-symbol-list-extended))
